(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{168:function(e,t,n){},169:function(e,t,n){},196:function(e,t,n){},217:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(44),c=n.n(a),s=(n(168),n(169),n(16)),o=n(24),i=n(123),l=n(7),u=n(10),d=n(5),b=n(55),j=n(122),p=n(49),h=n(87),O=n(11),x=n.n(O),f=n(2);var m=function(){var e=Object(r.useState)(!1),t=Object(d.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(),i=Object(d.a)(c,2),O=i[0],m=i[1],g=Object(r.useState)(),v=Object(d.a)(g,2),C=v[0],w=v[1],k=Object(r.useState)(!1),y=Object(d.a)(k,2),S=y[0],_=y[1],E=Object(h.a)(),A=Object(s.e)(),F=function(){var e=Object(u.a)(Object(l.a)().mark((function e(){var t,n,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(!0),O&&C){e.next=5;break}return E({title:"Please fill all the fields",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),_(!1),e.abrupt("return");case 5:return e.prev=5,t={headers:{"Content-type":"application/json"}},e.next=9,x.a.post("/api/user/login",{email:O,password:C},t);case 9:n=e.sent,r=n.data,E({title:"Login Successful",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),localStorage.setItem("userInfo",JSON.stringify(r)),_(!1),A.push("/chats"),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(5),E({title:"Error Occured!",description:e.t0.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),_(!1);case 21:case"end":return e.stop()}}),e,null,[[5,17]])})));return function(){return e.apply(this,arguments)}}();return Object(f.jsxs)(o.i,{spacing:"5px",children:[Object(f.jsxs)(b.a,{id:"email",isRequired:!0,children:[Object(f.jsx)(b.b,{children:"Email"}),Object(f.jsx)(j.a,{placeholder:"Enter Your Email",value:O,onChange:function(e){return m(e.target.value)}})]}),Object(f.jsxs)(b.a,{id:"password",isRequired:!0,children:[Object(f.jsx)(b.b,{children:"Password"}),Object(f.jsxs)(j.b,{children:[Object(f.jsx)(j.a,{type:n?"text":"password",value:C,placeholder:"Password",onChange:function(e){return w(e.target.value)}}),Object(f.jsx)(j.c,{width:"4.5rem",children:Object(f.jsx)(p.a,{h:"1.75rem",size:"sm",onClick:function(){return a(!n)},children:n?"Hide":"Show"})})]})]}),Object(f.jsx)(p.a,{colorScheme:"blue",width:"100%",style:{marginTop:15},onClick:F,isLoading:S,children:"Login"}),Object(f.jsx)(p.a,{variant:"solid",colorScheme:"red",width:"100%",onClick:function(){m("guest@example.com"),w("123456")},children:"Login as Guest"})]})};var g,v,C,w=function(){var e=Object(r.useState)(!1),t=Object(d.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(),i=Object(d.a)(c,2),O=i[0],m=i[1],g=Object(r.useState)(),v=Object(d.a)(g,2),C=v[0],w=v[1],k=Object(r.useState)(),y=Object(d.a)(k,2),S=y[0],_=y[1],E=Object(r.useState)(),A=Object(d.a)(E,2),F=A[0],z=A[1],N=Object(r.useState)(),B=Object(d.a)(N,2),I=B[0],P=B[1],W=Object(r.useState)(!1),R=Object(d.a)(W,2),U=R[0],D=R[1],L=function(){return a(!n)},M=Object(h.a)(),J=Object(s.e)(),G=function(){var e=Object(u.a)(Object(l.a)().mark((function e(){var t,n,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D(!0),O&&C&&F&&S){e.next=5;break}return M({title:"Please Fill all the Fields",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),D(!1),e.abrupt("return");case 5:if(F===S){e.next=8;break}return M({title:"Passwords do not match",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 8:return e.prev=8,t={headers:{"Content-type":"application/json"}},e.next=12,x.a.post("/api/user",{name:O,email:C,password:F,pic:I},t);case 12:n=e.sent,r=n.data,M({title:"Registration Successful",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),localStorage.setItem("userInfo",JSON.stringify(r)),D(!1),J.pushState("/chats"),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(8),M({title:"Error Occured!",description:e.t0.data.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),D(!1);case 24:case"end":return e.stop()}}),e,null,[[8,20]])})));return function(){return e.apply(this,arguments)}}();return Object(f.jsxs)(o.i,{spacing:"5px",children:[Object(f.jsxs)(b.a,{id:"first-name",isRequired:!0,children:[Object(f.jsx)(b.b,{children:"Name"}),Object(f.jsx)(j.a,{placeholder:"Enter Your Name",onChange:function(e){return m(e.target.value)}})]}),Object(f.jsxs)(b.a,{id:"email",isRequired:!0,children:[Object(f.jsx)(b.b,{children:"Email"}),Object(f.jsx)(j.a,{placeholder:"Enter Your Email",onChange:function(e){return w(e.target.value)}})]}),Object(f.jsxs)(b.a,{id:"password",isRequired:!0,children:[Object(f.jsx)(b.b,{children:"Password"}),Object(f.jsxs)(j.b,{children:[Object(f.jsx)(j.a,{type:n?"text":"password",placeholder:"Password",onChange:function(e){return z(e.target.value)}}),Object(f.jsx)(j.c,{width:"4.5rem",children:Object(f.jsx)(p.a,{h:"1.75rem",size:"sm",onClick:L,children:n?"Hide":"Show"})})]})]}),Object(f.jsxs)(b.a,{id:"password",isRequired:!0,children:[Object(f.jsx)(b.b,{children:"Confirm Password"}),Object(f.jsxs)(j.b,{children:[Object(f.jsx)(j.a,{type:n?"text":"password",placeholder:"Confirm Password",onChange:function(e){return _(e.target.value)}}),Object(f.jsx)(j.c,{width:"4.5rem",children:Object(f.jsx)(p.a,{h:"1.75rem",size:"sm",onClick:L,children:n?"Hide":"Show"})})]})]}),Object(f.jsxs)(b.a,{children:[Object(f.jsx)(b.b,{children:"Upload your Picture"}),Object(f.jsx)(j.a,{type:"file",p:1.5,accept:"image/*",onChange:function(e){return function(e){if(D(!0),void 0!==e){if("image/jpeg"!==e.type&&"image/png"!==e.type)return M({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void D(!1);var t=new FormData;t.append("file",e),t.append("upload_preset","chat-app"),t.append("could_name","dsunzcre7"),fetch("https://api.cloudinary.com/v1_1/dsunzcre7/images/upload",{method:"post",body:t}).then((function(e){return e.json()})).then((function(e){P(e.url.toString()),D(!1)})).catch((function(e){console.log(e),D(!1)}))}else M({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"})}(e.target.files[0])}})]}),Object(f.jsx)(p.a,{colorScheme:"blue",width:"100%",style:{marginTop:15},onClick:G,isLoading:U,children:"Sign Up"})]})},k=function(){var e=Object(s.e)();return Object(r.useEffect)((function(){JSON.parse(localStorage.getItem("userInfo"))&&e.push("/chats")}),[e]),Object(f.jsxs)(o.d,{maxW:"xl",centerContent:!0,children:[Object(f.jsx)(o.b,{display:"flex",justifyContent:"center",p:3,bg:"white",w:"100%",m:"40px 0 15px 0",borderRadius:"lg",borderWidth:"1px",children:Object(f.jsx)(o.h,{fontSize:"4xl",fontFamily:"Work sans",color:"black",children:"Chat App"})}),Object(f.jsx)(o.b,{bg:"white",width:"100%",p:4,borderRadius:"lg",borderWidth:"1px",children:Object(f.jsxs)(i.e,{variant:"soft-rounded",children:[Object(f.jsxs)(i.b,{children:[Object(f.jsx)(i.a,{width:"50%",children:"Login"}),Object(f.jsx)(i.a,{width:"50%",children:"Sign Up"})]}),Object(f.jsxs)(i.d,{children:[Object(f.jsx)(i.c,{children:Object(f.jsx)(m,{})}),Object(f.jsx)(i.c,{children:Object(f.jsx)(w,{})})]})]})})]})},y=Object(r.createContext)(),S=function(){return Object(r.useContext)(y)},_=function(e){var t=e.children,n=Object(r.useState)(),a=Object(d.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(),l=Object(d.a)(i,2),u=l[0],b=l[1],j=Object(r.useState)(),p=Object(d.a)(j,2),h=p[0],O=p[1],x=Object(r.useState)([]),m=Object(d.a)(x,2),g=m[0],v=m[1],C=Object(r.useState)([]),w=Object(d.a)(C,2),k=w[0],S=w[1],_=Object(r.useState)([]),E=Object(d.a)(_,2),A=E[0],F=E[1],z=Object(r.useState)(!1),N=Object(d.a)(z,2),B=N[0],I=N[1],P=Object(s.e)();return Object(r.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userInfo"));O(e),e||P.push("/")}),[P]),Object(f.jsx)(y.Provider,{value:{user:h,setUser:O,selectedChat:c,setSelectedChat:o,selectedBoard:u,setSelectedBoard:b,chats:g,setChats:v,boards:k,setBoards:S,notification:A,setNotification:F,isNoteModalOpen:B,setIsNoteModalOpen:I},children:t})},E=n(31),A=n(125),F=n(137),z=n(124),N=n(136),B=n(17),I=n(60),P=n(8),W=n(85),R=function(e){var t=e.user,n=e.children,a=Object(P.d)(),c=a.isOpen,s=a.onOpen,i=a.onClose;return Object(r.useEffect)((function(){return console.log("passowrdchanemodal mounted"),function(){console.log("PasswordChangeModal unmounted")}})),Object(f.jsxs)(f.Fragment,{children:[n?Object(f.jsx)("span",{onClick:s,children:n}):Object(f.jsx)(p.b,{display:{base:"flex"},icon:Object(f.jsx)(B.f,{}),onClick:s}),Object(f.jsxs)(N.f,{size:"lg",isOpen:c,onClose:i,isCentered:!0,children:[Object(f.jsx)(N.l,{}),Object(f.jsxs)(N.i,{h:"410px",bg:"white",children:[Object(f.jsx)(N.k,{fontSize:"40px",fontFamily:"Work sans",display:"flex",justifyContent:"center",children:t.name}),Object(f.jsx)(N.h,{}),Object(f.jsxs)(N.g,{display:"flex",flexDir:"column",alignItems:"center",justifyContent:"space-between",children:[Object(f.jsx)(W.a,{borderRadius:"full",boxSize:"150px",src:t.pic,alt:t.name}),Object(f.jsxs)(o.h,{fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",children:["Email: ",t.email]})]}),Object(f.jsx)(N.j,{children:Object(f.jsx)(p.a,{colorScheme:"blue",mr:3,onClick:i,children:"Close"})})]})]})]})},U=n(21),D=function(){return Object(f.jsxs)(o.g,{children:[Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"}),Object(f.jsx)(U.a,{height:"45px"})]})},L=function(e){var t=e.user,n=e.handleFunction;return Object(f.jsxs)(o.b,{onClick:n,cursor:"pointer",bg:"#E8E8E8",_hover:{background:"#38B2AC",color:"white"},w:"100%",display:"flex",alignItems:"center",color:"black",px:3,py:2,mb:2,borderRadius:"lg",children:[Object(f.jsx)(z.a,{mr:2,size:"sm",cursor:"pointer",name:t.name,src:t.pic}),Object(f.jsxs)(o.b,{children:[Object(f.jsx)(o.h,{children:t.name}),Object(f.jsxs)(o.h,{fontSize:"xs",children:[Object(f.jsx)("b",{children:"Email : "}),t.email]})]})]})},M=function(e,t){return t[0]._id===e._id?t[1].name:t[0].name},J=function(e,t,n,r){return n<e.length-1&&(e[n+1].sender._id!==t.sender._id||void 0===e[n+1].sender._id)&&e[n].sender._id!==r},G=function(e,t,n){return t===e.length-1&&e[e.length-1].sender._id!==n&&e[e.length-1].sender._id},T=function(e,t,n,r){return n<e.length-1&&e[n+1].sender._id===t.sender._id&&e[n].sender._id!==r?33:n<e.length-1&&e[n+1].sender._id!==t.sender._id&&e[n].sender._id!==r||n===e.length-1&&e[n].sender._id!==r?0:"auto"},q=function(e,t,n){return n>0&&e[n-1].sender._id===t.sender._id},Y=function(e){var t=e.isOpen,n=e.onClose,a=e.onChangePassword,c=Object(r.useState)(""),s=Object(d.a)(c,2),o=s[0],i=s[1],b=Object(r.useState)(""),O=Object(d.a)(b,2),m=O[0],g=O[1],v=Object(r.useState)(""),C=Object(d.a)(v,2),w=C[0],k=C[1],y=S().user,_=Object(h.a)();Object(r.useEffect)((function(){return console.log("PasswordChangeModal mounted"),function(){console.log("PasswordChangeModal unmounted")}}),[]);var E=function(){var e=Object(u.a)(Object(l.a)().mark((function e(){var t,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m===w){e.next=3;break}return console.error("New passwords do not match"),e.abrupt("return");case 3:return e.prev=3,t={headers:{Authorization:"Bearer ".concat(y.token)}},e.next=7,x.a.post("/api/user/password",{currentPassword:o,newPassword:m},t);case 7:r=e.sent,r.data,_({title:"Password changed successfully",status:"success",duration:5e3,isClosable:!0,position:"top-left"}),n(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),_({title:"Error changing passord",status:"error",duration:5e3,isClosable:!0,position:"top-left"});case 16:a(o,m),i(""),g(""),k(""),n();case 21:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(){return e.apply(this,arguments)}}();return Object(f.jsxs)(N.f,{isOpen:t,onClose:n,isCentered:!0,children:[Object(f.jsx)(N.l,{}),Object(f.jsxs)(N.i,{children:[Object(f.jsx)(N.k,{children:"Change Password"}),Object(f.jsx)(N.h,{}),Object(f.jsxs)(N.g,{children:[Object(f.jsx)(j.a,{type:"password",placeholder:"Current Password",value:o,onChange:function(e){return i(e.target.value)}}),Object(f.jsx)(j.a,{type:"password",placeholder:"New Password",value:m,onChange:function(e){return g(e.target.value)}}),Object(f.jsx)(j.a,{type:"password",placeholder:"Confirm New Password",value:w,onChange:function(e){return k(e.target.value)}})]}),Object(f.jsxs)(N.j,{children:[Object(f.jsx)(p.a,{colorScheme:"blue",mr:3,onClick:E,children:"Change Password"}),Object(f.jsx)(p.a,{onClick:n,children:"Cancel"})]})]})]})},H=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)([]),i=Object(d.a)(c,2),b=i[0],O=i[1],m=Object(r.useState)(!1),g=Object(d.a)(m,2),v=g[0],C=g[1],w=Object(r.useState)(!1),k=Object(d.a)(w,2),y=k[0],_=k[1],W=Object(P.d)(),U=W.isOpen,J=W.onOpen,G=W.onClose,T=S(),q=T.user,H=T.setSelectedChat,K=T.chats,Q=T.setChats,V=T.notification,X=T.setNotification,Z=Object(s.e)(),$=Object(P.d)(),ee=$.isOpen,te=($.onOpen,$.onClose),ne=Object(h.a)(),re=function(){var e=Object(u.a)(Object(l.a)().mark((function e(){var t,r,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return ne({title:"Please Enter something in search",status:"warning",duration:5e3,isClosable:!0,position:"top-left"}),e.abrupt("return");case 3:return e.prev=3,C(!0),t={headers:{Authorization:"Bearer ".concat(q.token)}},e.next=8,x.a.get("/api/user?search=".concat(n),t);case 8:r=e.sent,a=r.data,C(!1),O(a),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),ne({title:"Error Occured!",description:"Failed to load the search results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=Object(u.a)(Object(l.a)().mark((function e(t){var n,r,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,_(!0),n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(q.token)}},e.next=5,x.a.post("/api/chat",{userId:t},n);case 5:r=e.sent,a=r.data,console.log(a),K.find((function(e){return e._id===a._id}))||Q([a].concat(Object(E.a)(K))),H(a),_(!1),te(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),ne({title:"Error fetching the chat",description:e.t0.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(o.b,{display:"flex",justifyContent:"space-between",alignItems:"center",bg:"white",w:"100%",p:"5px 10px 5px 10px",borderWidth:"5px",children:[Object(f.jsx)(A.a,{label:"Search users to chat",hasArrow:!0,placement:"bottom-end",children:Object(f.jsxs)(p.a,{variant:"ghost",onClick:ee,children:[Object(f.jsx)("i",{class:"fas fa-search"}),Object(f.jsx)(o.h,{display:{base:"none",md:"flex"},px:"4",children:"Search User"})]})}),Object(f.jsx)(o.h,{fontSize:"2xl",fontFamily:"Work sans",children:"Notes and chats"}),Object(f.jsxs)("div",{children:[Object(f.jsxs)(F.a,{children:[Object(f.jsx)(F.b,{p:1,children:Object(f.jsx)(B.c,{fontSize:"2xl",m:1})}),Object(f.jsxs)(F.e,{pl:2,children:[!V.length&&"No new messages",V.map((function(e){return Object(f.jsx)(F.d,{onClick:function(){H(e.chat),X(V.filer((function(t){return t!==e})))},children:e.chat.isGroupChat?"New Message in ".concat(e.chat.chatName):"New message from ".concat(M(q,e.chat.users))},e._id)}))]})]}),Object(f.jsxs)(F.a,{children:[Object(f.jsx)(F.b,{as:p.a,rightIcon:Object(f.jsx)(B.d,{}),children:Object(f.jsx)(z.a,{size:"sm",cursor:"pointer",name:q.name,src:q.pic})}),Object(f.jsxs)(F.e,{children:[Object(f.jsx)(R,{user:q,children:Object(f.jsx)(F.d,{children:"My Profile"})}),Object(f.jsx)(F.d,{onClick:J,children:"Change Password"}),Object(f.jsx)(F.c,{}),Object(f.jsx)(F.d,{onClick:function(){localStorage.removeItem("userInfo"),Z.push("/")},children:"Logout"})]})]})]})]}),Object(f.jsxs)(N.a,{placement:"left",onClose:te,isOpen:ee,children:[Object(f.jsx)(N.e,{}),Object(f.jsxs)(N.c,{children:[Object(f.jsx)(N.d,{borderBottomWidth:"1px",children:"Search Users"}),Object(f.jsxs)(N.b,{children:[Object(f.jsxs)(o.b,{display:"flex",pb:2,children:[Object(f.jsx)(j.a,{placeholder:"Search by name or email",mr:2,value:n,onChange:function(e){return a(e.target.value)}}),Object(f.jsx)(p.a,{onClick:re,children:"Go"})]}),v?Object(f.jsx)(D,{}):null===b||void 0===b?void 0:b.map((function(e){return Object(f.jsx)(L,{user:e,handleFunction:function(){return ae(e._id)}},e._id)})),y&&Object(f.jsx)(I.a,{ml:"auto",display:"flex"})]})]})]}),Object(f.jsx)(Y,{isOpen:U,onClose:G,onChangePassword:function(e,t){q._id?(q.changePassword(e,t),console.log("Password changed succesfully")):console.error("User not found")}})]})},K=function(e){var t=e.user,n=e.handleFunction;return Object(f.jsxs)(o.b,{px:2,py:1,borderRadius:"lg",m:1,mb:2,variant:"solid",fontSize:12,fontWeight:"bold",backgroundColor:"purple",color:"white",cursor:"pointer",onClick:n,children:[t.name,Object(f.jsx)(B.e,{pl:1})]})},Q=function(e){var t=e.children,n=Object(P.d)(),a=n.isOpen,c=n.onOpen,s=n.onClose,i=Object(r.useState)(),O=Object(d.a)(i,2),m=O[0],g=O[1],v=Object(r.useState)([]),C=Object(d.a)(v,2),w=C[0],k=C[1],y=Object(r.useState)(""),_=Object(d.a)(y,2),A=_[0],F=_[1],z=Object(r.useState)([]),B=Object(d.a)(z,2),I=B[0],W=B[1],R=Object(r.useState)(!1),U=Object(d.a)(R,2),D=U[0],M=U[1],J=Object(h.a)(),G=S(),T=G.user,q=G.chats,Y=G.setChats,H=function(){var e=Object(u.a)(Object(l.a)().mark((function e(t){var n,r,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(F(t),t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,M(!0),n={headers:{Authorization:"Bearer ".concat(T.token)}},e.next=8,x.a.get("/api/user?search=".concat(A),n);case 8:r=e.sent,a=r.data,M(!1),W(a),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),J({title:"Error Occured!",description:"Failed to load the search results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 17:M(!1);case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(u.a)(Object(l.a)().mark((function e(){var t,n,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m&&w){e.next=3;break}return J({title:"Please fill all the fields",status:"warning",duration:5e3,isClosable:!0,position:"top"}),e.abrupt("return");case 3:return e.prev=3,t={headers:{Authorization:"Bearer ".concat(T.token)}},e.next=7,x.a.post("/api/chat/group",{name:m,users:JSON.stringify(w.map((function(e){return e._id})))},t);case 7:n=e.sent,r=n.data,Y([r].concat(Object(E.a)(q))),s(),J({title:"New group chat created",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),J({title:"Failed to create the chat!",description:e.t0.data,status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(){return e.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("span",{onClick:c,children:t}),Object(f.jsxs)(N.f,{isOpen:a,onClose:s,children:[Object(f.jsx)(N.l,{}),Object(f.jsxs)(N.i,{children:[Object(f.jsx)(N.k,{fontSize:"35px",fontFamily:"Work sans",display:"flex",justifyContent:"center",children:"Create Group Chat"}),Object(f.jsx)(N.h,{}),Object(f.jsxs)(N.g,{display:"flex",flexDir:"column",alignItems:"center",children:[Object(f.jsx)(b.a,{children:Object(f.jsx)(j.a,{placeholder:"Chat Name",mb:3,onChange:function(e){return g(e.target.value)}})}),Object(f.jsx)(b.a,{children:Object(f.jsx)(j.a,{placeholder:"Add Users eg: Basse, John",mb:1,onChange:function(e){return H(e.target.value)}})}),Object(f.jsx)(o.b,{w:"100%",display:"flex",flexWrap:"wrap",children:w.map((function(e){return Object(f.jsx)(K,{user:e,handleFunction:function(){return t=e,void k(w.filter((function(e){return e._id!==t._id})));var t}},T._id)}))}),D?Object(f.jsx)("div",{children:"loading"}):null===I||void 0===I?void 0:I.slice(0,4).map((function(e){return Object(f.jsx)(L,{user:e,handleFunction:function(){return t=e,void(w.includes(t)?J({title:"User already added",status:"warning",duration:5e3,isClosable:!0,position:"top"}):k([].concat(Object(E.a)(w),[t])));var t}},e._id)}))]}),Object(f.jsx)(N.j,{children:Object(f.jsx)(p.a,{colorScheme:"blue",onClick:Q,children:"Create chat"})})]})]})]})},V=function(e){var t=e.fetchAgain,n=Object(r.useState)(),a=Object(d.a)(n,2),c=a[0],s=a[1],i=S(),b=i.selectedChat,j=i.setSelectedChat,O=i.user,m=i.chats,g=i.setChats,v=Object(h.a)(),C=function(){var e=Object(u.a)(Object(l.a)().mark((function e(){var t,n,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(O.id),e.prev=1,t={headers:{Authorization:"Bearer ".concat(O.token)}},e.next=5,x.a.get("/api/chat",t);case 5:n=e.sent,r=n.data,console.log(r),g(r),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),v({title:"Error occured!",description:"Failed to load the chats",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){s(JSON.parse(localStorage.getItem("userInfo"))),C()}),[t]),Object(f.jsxs)(o.b,{display:{base:b?"none":"flex",md:"flex"},flexDir:"column",alignItems:"center",p:3,bg:"white",w:{base:"100%",md:"31%"},borderRadius:"lg",borderWidth:"1px",children:[Object(f.jsxs)(o.b,{pb:3,px:3,fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",display:"flex",w:"100%",justifyContent:"space-between",alignItems:"center",children:["My Chats",Object(f.jsx)(Q,{children:Object(f.jsx)(p.a,{display:"flex",fontSize:{base:"17px",md:"10px",lg:"17px"},rightIcon:Object(f.jsx)(B.a,{}),children:"New Group Chat"})})]}),Object(f.jsx)(o.b,{display:"flex",flexDir:"column",p:3,bg:"#F8F8F8",w:"100%",h:"100%",borderRadius:"lg",overflow:"hidden",children:m?Object(f.jsx)(o.g,{overflowY:"scroll",children:m.map((function(e){return Object(f.jsx)(o.b,{onClick:function(){return j(e)},cursor:"pointer",bg:b===e?"#38B2AC":"#E8E8E8",color:b===e?"white":"black",px:3,py:2,borderRadius:"lg",children:Object(f.jsx)(o.h,{children:e.isGroupChat?e.chatName:M(c,e.users)})},e._id)}))}):Object(f.jsx)(D,{})})]})},X=function(e){var t=e.fetchAgain,n=e.setFetchAgain,a=e.fetchMessages,c=Object(P.d)(),s=c.isOpen,i=c.onOpen,O=c.onClose,m=Object(r.useState)(),g=Object(d.a)(m,2),v=g[0],C=g[1],w=Object(r.useState)(""),k=Object(d.a)(w,2),y=k[0],_=k[1],E=Object(r.useState)([]),A=Object(d.a)(E,2),F=A[0],z=A[1],W=Object(r.useState)(!1),R=Object(d.a)(W,2),U=R[0],D=R[1],M=Object(r.useState)(!1),J=Object(d.a)(M,2),G=J[0],T=J[1],q=Object(h.a)(),Y=S(),H=Y.selectedChat,Q=Y.setSelectedChat,V=Y.user,X=function(){var e=Object(u.a)(Object(l.a)().mark((function e(r){var c,s,o;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H.groupAdmin._id===V._id||r._id===V.id){e.next=3;break}return q({title:"Only admins can remove someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:return e.prev=3,D(!0),c={headers:{Authorization:"Bearer ".concat(V.token)}},e.next=8,x.a.put("api/chat/groupremove",{chatId:H._id,userId:r._id},c);case 8:s=e.sent,o=s.data,r._id===V.id?Q():Q(o),n(!t),a(),D(!1),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),q({title:"Error occured!",status:"error",description:e.t0.data.message,duration:5e3,isClosable:!0,position:"bottom"});case 19:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(u.a)(Object(l.a)().mark((function e(r){var a,c,s;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!H.users.find((function(e){return e._id===r._id}))){e.next=3;break}return q({title:"User Already in group!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:if(H.groupAdmin._id===V._id){e.next=6;break}return q({title:"Only admins can add someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 6:return e.prev=6,D(!0),a={headers:{Authorization:"Bearer ".concat(V.token)}},e.next=11,x.a.put("/api/chat/groupadd",{chatId:H._id,userId:r._id},a);case 11:c=e.sent,s=c.data,Q(s),n(!t),D(!1),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(6),q({title:"Error Occured!",description:e.t0.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),D(!1);case 22:case"end":return e.stop()}}),e,null,[[6,18]])})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(u.a)(Object(l.a)().mark((function e(){var r,a,c;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,T(!0),r={headers:{Authorization:"Bearer ".concat(V.token)}},e.next=7,x.a.put("/api/chat/rename",{chatId:H._id,chatName:v},r);case 7:a=e.sent,c=a.data,Q(c),n(!t),T(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),q({title:"Error Occured!",description:e.t0.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),T(!1);case 18:C("");case 19:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(u.a)(Object(l.a)().mark((function e(t){var n,r,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(t),t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,D(!0),n={headers:{Authorization:"Bearer ".concat(V.token)}},e.next=8,x.a.get("/api/user?search=".concat(y),n);case 8:r=e.sent,a=r.data,console.log(a),D(!1),z(a),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),q({title:"Error Occured!",description:"Failed to load the search results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 18:D(!1);case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(p.b,{display:{base:"flex"},icon:Object(f.jsx)(B.f,{}),onClick:i}),Object(f.jsxs)(N.f,{isOpen:s,onClose:O,isCentered:!0,children:[Object(f.jsx)(N.l,{}),Object(f.jsxs)(N.i,{children:[Object(f.jsx)(N.k,{fontSize:"35px",fontFamily:"Work sans",display:"flex",justifyContent:"center",children:H.chatName}),Object(f.jsx)(N.h,{}),Object(f.jsxs)(N.g,{children:[Object(f.jsx)(o.b,{w:"100%",display:"flex",flexWrap:"wrap",pb:3,children:H.users.map((function(e){return Object(f.jsx)(K,{user:e,handleFunction:function(){return X(e)}},V._id)}))}),Object(f.jsxs)(b.a,{display:"flex",children:[Object(f.jsx)(j.a,{placeholder:"Chat name",mb:3,value:v,onChange:function(e){return C(e.target.value)}}),Object(f.jsx)(p.a,{variant:"solid",colorScheme:"teal",ml:1,isLoading:G,onClick:$,children:"Update"})]}),Object(f.jsx)(b.a,{children:Object(f.jsx)(j.a,{placeholder:"Add user to group",mb:1,onChange:function(e){return ee(e.target.value)}})}),U?Object(f.jsx)(I.a,{size:"lg"}):null===F||void 0===F?void 0:F.map((function(e){return Object(f.jsx)(L,{user:e,handleFunction:function(){return Z(e)}},e._id)}))]}),Object(f.jsx)(N.j,{children:Object(f.jsx)(p.a,{onClick:function(){return X(V)},colorScheme:"red",children:"Leave Group"})})]})]})]})},Z=(n(196),n(140)),$=function(e){var t=e.messages,n=S().user;return Object(f.jsx)(Z.a,{children:t&&t.map((function(e,r){return Object(f.jsxs)("div",{style:{display:"flex"},children:[(J(t,e,r,n._id)||G(t,r,n._id))&&Object(f.jsx)(A.a,{label:e.sender.name,placement:"bottom-start",hasArrow:!0,children:Object(f.jsx)(z.a,{mt:"7px",mr:1,size:"sm",cursor:"pointer",name:e.sender.name,src:e.sender.pic})}),Object(f.jsx)("span",{style:{backgroundColor:"".concat(e.sender._id===n._id?"#BEE3F8":"#B9F5D0"),borderRadius:"20px",padding:"5px 15px",maxWidth:"75%",marginLeft:T(t,e,r,n._id),marginTop:q(t,e,r,n._id)?3:10},children:e.content})]},e._id)}))})},ee=n(94),te=function(e){var t=e.fetchAgain,n=e.setFetchAgain,a=Object(r.useState)([]),c=Object(d.a)(a,2),s=c[0],i=c[1],O=Object(r.useState)(!1),m=Object(d.a)(O,2),C=m[0],w=m[1],k=Object(r.useState)(),y=Object(d.a)(k,2),_=y[0],A=y[1],F=Object(r.useState)(!1),z=Object(d.a)(F,2),N=z[0],P=z[1],W=Object(r.useState)(!1),U=Object(d.a)(W,2),D=U[0],L=U[1],J=Object(r.useState)(!1),G=Object(d.a)(J,2),T=G[0],q=G[1],Y=Object(h.a)(),H=S(),K=H.user,Q=H.selectedChat,V=H.setSelectedChat,Z=H.notification,te=H.SetNotification,ne=function(){var e=Object(u.a)(Object(l.a)().mark((function e(){var t,n,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Q){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t={headers:{Authorization:"Bearer ".concat(K.token)}},w(!0),e.next=7,x.a.get("/api/message/".concat(Q._id),t);case 7:n=e.sent,r=n.data,i(r),w(!1),g.emit("join chat",Q._id),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),Y({title:"Error Occured!",description:"Failed to load the messages",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){(g=Object(ee.a)("http://localhost:5000")).emit("setup",K),g.on("connected",(function(){return P(!0)})),g.on("typing",(function(){return q(!0)})),g.on("stop typing",(function(){return L(!1)}))}),[]),Object(r.useEffect)((function(){ne(),v=Q}),[Q]),Object(r.useEffect)((function(){g.on("message recieved",(function(e){v&&v._id===e.chat._id?i([].concat(Object(E.a)(s),[e])):Z.includes(e)&&(te([e].concat(Object(E.a)(Z))),n(!t))}))}));var re,ae,ce=function(){var e=Object(u.a)(Object(l.a)().mark((function e(t){var n,r,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key||!_){e.next=16;break}return g.emit("stop typing",Q._id),e.prev=2,n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(K.token)}},A(""),e.next=7,x.a.post("/api/message",{content:_,chatId:Q._id},n);case 7:r=e.sent,a=r.data,g.emit("new message",a),i([].concat(Object(E.a)(s),[a])),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),Y({title:"Error occured!",description:"Failed to send the message",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsx)(f.Fragment,{children:Q?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(o.h,{fontSize:{base:"28px",md:"30px"},pb:3,px:2,w:"100%",fontFamily:"Work sans",display:"flex",justifyContent:{base:"space-between"},alignItems:"center",children:[Object(f.jsx)(p.b,{display:{base:"flex",md:"none"},icon:Object(f.jsx)(B.b,{}),onClick:function(){return V("")}}),Q.isGroupChat?Object(f.jsxs)(f.Fragment,{children:[Q.chatName.toUpperCase(),Object(f.jsx)(X,{fetchAgain:t,setFetchAgain:n,fetchMessages:ne})]}):Object(f.jsxs)(f.Fragment,{children:[M(K,Q.users),Object(f.jsx)(R,{user:(re=K,ae=Q.users,ae[0]._id===re._id?ae[1]:ae[0])})]})]}),Object(f.jsxs)(o.b,{display:"flex",flexDir:"column",justifyContent:"flex-end",p:3,bg:"#E8E8E8",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden",children:[C?Object(f.jsx)(I.a,{size:"xl",w:20,h:20,alignSelf:"center",margin:"auto"}):Object(f.jsx)("div",{className:"messages",children:Object(f.jsx)($,{messages:s})}),Object(f.jsxs)(b.a,{onKeyDown:ce,isRequired:!0,mt:3,children:[T?Object(f.jsx)("div",{children:"..."}):Object(f.jsx)(f.Fragment,{children:"."}),Object(f.jsx)(j.a,{variant:"filled",bg:"#E0E0E0",placeholder:"Enter a message..",onChange:function(e){if(A(e.target.value),N){D||(L(!0),g.emit("typing",Q._id));var t=(new Date).getTime();setTimeout((function(){(new Date).getTime()-t>=300&&D&&(g.emit("stop typing",Q._id),L(!1))}),300)}},value:_})]})]})]}):Object(f.jsx)(o.b,{display:"flex",alignItems:"center",justifyContent:"center",h:"100%",children:Object(f.jsx)(o.h,{fontSize:"3xl",pb:3,fontFamily:"Work sans",children:"Click on a user to start chatting"})})})},ne=function(e){var t=e.fetchAgain,n=e.setFetchAgain,r=S().selectedChat;return Object(f.jsx)(o.b,{display:{base:r?"flex":"none",md:"flex"},alignItems:"center",flexDir:"column",p:3,bg:"white",w:{base:"100%",md:"68%"},borderRadius:"lg",borderWidth:"1px",children:Object(f.jsx)(te,{fetchAgain:t,setFetchAgain:n})})},re=function(){var e=S().user,t=Object(r.useState)(!1),n=Object(d.a)(t,2),a=n[0],c=n[1];return Object(f.jsxs)("div",{style:{width:"100%"},children:[e&&Object(f.jsx)(H,{}),Object(f.jsxs)(o.b,{display:"flex",justifyContent:"space-between",w:"100%",h:"91.5vh",p:"10px",children:[e&&Object(f.jsx)(V,{fetchAgain:a}),e&&Object(f.jsx)(ne,{fetchAgain:a,setFetchAgain:c})]})]})},ae=n(65),ce=n(126),se=function(e){var t=e.isOpen,n=e.onClose,a=e.onCreateNote,c=e.boardId,s=Object(r.useState)(""),o=Object(d.a)(s,2),i=o[0],l=o[1],u=Object(r.useState)(""),b=Object(d.a)(u,2),h=b[0],O=b[1];return Object(f.jsxs)(N.f,{isOpen:t,onClose:n,size:"md",children:[Object(f.jsx)(N.l,{}),Object(f.jsxs)(N.i,{children:[Object(f.jsx)(N.k,{children:"Create a New Note"}),Object(f.jsx)(N.h,{}),Object(f.jsxs)(N.g,{children:[Object(f.jsx)(j.a,{placeholder:"Title",mb:4,value:i,onChange:function(e){return l(e.target.value)}}),Object(f.jsx)(ce.a,{placeholder:"Content",value:h,onChange:function(e){return O(e.target.value)}})]}),Object(f.jsx)(N.j,{children:Object(f.jsx)(p.a,{colorScheme:"teal",onClick:function(){""!==i.trim()&&""!==h.trim()&&(a({title:i,content:h,boardId:c}),n(),l(""),O(""))},children:"Create Note"})})]})]})},oe=function(e){e.children;var t=Object(P.d)(),n=t.isOpen,a=t.onOpen,c=t.onClose,s=Object(r.useState)(""),i=Object(d.a)(s,2),O=i[0],m=i[1],g=Object(r.useState)(""),v=Object(d.a)(g,2),C=v[0],w=v[1],k=Object(r.useState)([]),y=Object(d.a)(k,2),_=y[0],A=y[1],F=Object(r.useState)([]),z=Object(d.a)(F,2),I=z[0],W=z[1],R=S(),U=R.user,D=(R.createBoard,Object(r.useState)(!1)),M=Object(d.a)(D,2),J=M[0],G=M[1],T=S(),q=T.boards,Y=T.setBoards,H=Object(h.a)(),Q=function(){var e=Object(u.a)(Object(l.a)().mark((function e(t){var n,r,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w(t),t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,G(!0),n={headers:{Authorization:"Bearer ".concat(U.token)}},e.next=8,x.a.get("/api/user?search=".concat(C),n);case 8:r=e.sent,a=r.data,G(!1),A(a),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),H({title:"Error Occured!",description:"Failed to load the search results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 17:G(!1);case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(u.a)(Object(l.a)().mark((function e(){var t,n,r,a,s;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O&&I){e.next=3;break}return H({title:"Please fill all the fields",status:"warning",duration:5e3,isClosable:!0,position:"top"}),e.abrupt("return");case 3:return t=I.map((function(e){return{_id:e}})),console.log("Data being sent:",{boardName:O,users:t}),e.prev=5,n={headers:{Authorization:"Bearer ".concat(U.token)}},e.next=9,x.a.post("/api/board",{boardName:O,users:I.map((function(e){return e._id}))},n);case 9:r=e.sent,a=r.data,Y([a].concat(Object(E.a)(q))),c(),H({title:"New board created",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),s=e.t0.data.message||"Failed to create the board",H({title:"Failed to create the board!",description:s,status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 20:case"end":return e.stop()}}),e,null,[[5,16]])})));return function(){return e.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(p.a,{display:"flex",fontSize:{base:"17px",md:"10px",lg:"17px"},rightIcon:Object(f.jsx)(B.a,{}),onClick:a,children:"New Board"}),Object(f.jsxs)(N.f,{isOpen:n,onClose:c,children:[Object(f.jsx)(N.l,{}),Object(f.jsxs)(N.i,{children:[Object(f.jsx)(N.k,{children:"Create a New Board"}),Object(f.jsxs)(N.g,{display:"flex",flexDir:"column",alignItems:"center",children:[Object(f.jsx)(b.a,{children:Object(f.jsx)(j.a,{placeholder:"Enter Board Name",mb:3,onChange:function(e){return m(e.target.value)}})}),Object(f.jsx)(b.a,{children:Object(f.jsx)(j.a,{placeholder:"Add Users eg: Basse, John",mb:1,onChange:function(e){return Q(e.target.value)}})}),Object(f.jsx)(o.b,{w:"100%",display:"flex",flexWrap:"wrap",children:I.map((function(e){return Object(f.jsx)(K,{user:e,handleFunction:function(){return t=e,void W(I.filter((function(e){return e._id!==t._id})));var t}},e._id)}))}),J?Object(f.jsx)("div",{children:"loading"}):null===_||void 0===_?void 0:_.slice(0,4).map((function(e){return Object(f.jsx)(L,{user:e,handleFunction:function(){return t=e,void(I.includes(t)?H({title:"User already added",status:"warning",duration:5e3,isClosable:!0,position:"top"}):W([].concat(Object(E.a)(I),[t])));var t}},e._id)}))]}),Object(f.jsx)(N.j,{children:Object(f.jsx)(p.a,{colorScheme:"blue",onClick:V,children:"Create board"})})]})]})]})},ie=n(40),le=n(106),ue=n.n(le),de=n(53),be=function(e){var t=e.id,n=e.title,a=e.content,c=(e.sender,e.createdAt),s=e.updatedAt,i=e.onEdit,b=e.onRemove,j=e.onDragStop,O=e.xpos,m=e.ypos,g=e.color,v=Object(r.useState)("yellow"),C=Object(d.a)(v,2),w=(C[0],C[1]),k=S().user,y=Object(h.a)(),_=function(e){w(e),console.log(e),E(e)},E=function(){var e=Object(u.a)(Object(l.a)().mark((function e(n){var r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(k.token)}},e.next=4,x.a.put("/api/note/".concat(t),{color:n},r);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),y({title:"Error Occured!",description:"Failed to save the color to the server",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){}),[de.c]),Object(f.jsx)(ue.a,{position:{x:O,y:m},onStop:function(e,n){var r=n.x,a=n.y;console.log(r,a),j(t,{x:r,y:a})},children:Object(f.jsxs)(o.b,{borderWidth:"1px",borderRadius:"20px",p:4,width:"300px",backgroundColor:g,boxShadow:"md",transform:"translate(".concat(O,"px, ").concat(m,"px)"),_hover:{transform:"scale(1.02)"},children:[Object(f.jsxs)(o.e,{justify:"space-between",children:[Object(f.jsx)(o.c,{borderColor:"black",borderWidth:"4px",size:"30px",bg:"red.500",cursor:"pointer",onClick:function(){return _("red")}}),Object(f.jsx)(o.c,{borderColor:"black",borderWidth:"4px",size:"30px",bg:"green.500",cursor:"pointer",onClick:function(){return _("green")}}),Object(f.jsx)(o.c,{borderColor:"black",borderWidth:"4px",size:"30px",bg:"yellow.500",cursor:"pointer",onClick:function(){return _("yellow")}}),Object(f.jsx)(p.a,{size:"sm",colorScheme:"red",borderColor:"black",borderWidth:"4px",onClick:b,children:Object(f.jsx)(B.e,{})})]}),Object(f.jsx)(o.h,{fontWeight:"bold",fontSize:"2xl",mb:2,children:n}),Object(f.jsx)(o.h,{fontSize:"black",color:"black.600",mb:4,children:a}),Object(f.jsx)(o.h,{}),Object(f.jsx)(o.e,{justify:"space-between",children:Object(f.jsx)(o.a,{colorScheme:"teal",children:"Created: ".concat(c)})}),Object(f.jsx)(o.a,{colorScheme:"teal",children:"Last updated:  ".concat(s)}),Object(f.jsx)(p.a,{mt:1,onClick:i,children:"Edit"})]})})},je=function(e){e.fetchAgain,e.setFetchAgain;var t=e.fetchNotes,n=Object(P.d)(),a=n.isOpen,c=n.onOpen,s=n.onClose,i=Object(r.useState)(),O=Object(d.a)(i,2),m=O[0],g=O[1],v=Object(r.useState)(""),C=Object(d.a)(v,2),w=C[0],k=C[1],y=Object(r.useState)([]),_=Object(d.a)(y,2),E=_[0],A=_[1],F=Object(r.useState)(!1),z=Object(d.a)(F,2),W=z[0],R=z[1],U=Object(r.useState)(!1),D=Object(d.a)(U,2),M=D[0],J=D[1],G=Object(h.a)(),T=S(),q=T.selectedBoard,Y=T.setSelectedBoard,H=T.user,Q=function(){var e=Object(u.a)(Object(l.a)().mark((function e(n){var r,a,c;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q.boardAdmin._id===H._id||H._id===H.id){e.next=3;break}return G({title:"Only admins can remove someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:return e.prev=3,R(!0),r={headers:{Authorization:"Bearer ".concat(H.token)}},e.next=8,x.a.put("/api/board/boardremove",{boardId:q._id,userId:n._id},r);case 8:a=e.sent,c=a.data,n._id===H.id?Y():Y(c),t(),R(!1),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),G({title:"Error occured!",status:"error",description:e.t0.data.message,duration:5e3,isClosable:!0,position:"bottom"});case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(u.a)(Object(l.a)().mark((function e(){var t,n,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,J(!0),t={headers:{Authorization:"Bearer ".concat(H.token)}},e.next=7,x.a.put("/api/board/rename",{boardId:q._id,boardName:m},t);case 7:n=e.sent,r=n.data,Y(r),J(!1),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),G({title:"Error Occured!",description:e.t0.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),J(!1);case 17:g("");case 18:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(u.a)(Object(l.a)().mark((function e(t){var n,r,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k(t),t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,R(!0),n={headers:{Authorization:"Bearer ".concat(H.token)}},e.next=8,x.a.get("/api/user?search=".concat(w),n);case 8:r=e.sent,a=r.data,R(!1),A(a),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),G({title:"Error Occured!",description:"Failed to load the search results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 17:R(!1);case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(u.a)(Object(l.a)().mark((function e(t){var n,r,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!q.users.find((function(e){return e._id===t._id}))){e.next=3;break}return G({title:"User Already in group!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:if(q.boardAdmin._id===H._id){e.next=6;break}return G({title:"Only admins can add someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 6:return e.prev=6,R(!0),n={headers:{Authorization:"Bearer ".concat(H.token)}},e.next=11,x.a.put("/api/board/boardadd",{boardId:q._id,userId:t._id},n);case 11:r=e.sent,a=r.data,Y(a),R(!1),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(6),G({title:"Error Occured!",description:e.t0.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),R(!1);case 21:case"end":return e.stop()}}),e,null,[[6,17]])})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(p.b,{display:{base:"flex"},icon:Object(f.jsx)(B.f,{}),onClick:c}),Object(f.jsxs)(N.f,{isOpen:a,onClose:s,isCentered:!0,children:[Object(f.jsx)(N.l,{}),Object(f.jsxs)(N.i,{children:[Object(f.jsx)(N.k,{fontSize:"35px",fontFamily:"Work sans",display:"flex",justifyContent:"center",children:q.boardName}),Object(f.jsx)(N.h,{}),Object(f.jsxs)(N.g,{children:[Object(f.jsx)(o.b,{w:"100%",display:"flex",flexWrap:"wrap",pb:3,children:q.users.map((function(e){return Object(f.jsx)(K,{user:e,handleFunction:function(){return Q(e)}},H._id)}))}),Object(f.jsxs)(b.a,{display:"flex",children:[Object(f.jsx)(j.a,{placeholder:"Chat name",mb:3,value:m,onChange:function(e){return g(e.target.value)}}),Object(f.jsx)(p.a,{variant:"solid",colorScheme:"teal",ml:1,isLoading:M,onClick:V,children:"Update"})]}),Object(f.jsx)(b.a,{children:Object(f.jsx)(j.a,{placeholder:"Add user to group",mb:1,onChange:function(e){return X(e.target.value)}})}),W?Object(f.jsx)(I.a,{size:"lg"}):null===E||void 0===E?void 0:E.map((function(e){return Object(f.jsx)(L,{user:e,handleFunction:function(){return Z(e)}},e._id)}))]}),Object(f.jsx)(N.j,{children:Object(f.jsx)(p.a,{onClick:function(){return Q(H)},colorScheme:"red",children:"Leave Group"})})]})]})]})},pe=function(){var e=Object(r.useState)([]),t=Object(d.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),i=Object(d.a)(c,2),b=i[0],h=i[1],O=Object(r.useState)(""),m=Object(d.a)(O,2),g=(m[0],m[1],Object(r.useState)(!1)),v=Object(d.a)(g,2),w=v[0],k=v[1],y=Object(s.e)(),_=S(),A=_.selectedBoard,F=_.setSelectedBoard,z=_.user,B=Object(r.useState)(""),I=Object(d.a)(B,2),P=(I[0],I[1],Object(r.useState)("")),W=Object(d.a)(P,2),R=(W[0],W[1],Object(r.useState)(null)),U=Object(d.a)(R,2),D=(U[0],U[1],Object(r.useState)(!1)),L=Object(d.a)(D,2),M=L[0],J=L[1],G=Object(r.useState)(null),T=Object(d.a)(G,2),q=(T[0],T[1],S()),Y=(q.fetchAgain,q.setFetchAgain,Object(r.useState)(!1)),H=Object(d.a)(Y,2),K=(H[0],H[1]),Q=function(){h(null),J(!1)},V=function(){var e=Object(u.a)(Object(l.a)().mark((function e(t){var n,r,c;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(z.token)}},console.log(t),e.next=5,x.a.put("/api/note/".concat(t._id),{title:t.title,content:t.content},n);case 5:r=e.sent,c=r.data,console.log("Server response:",c),a((function(e){return e.map((function(e){return e.id===c._id?Object(ie.a)(Object(ie.a)({},c),{},{position:e.position}):e}))})),C.emit("new received",c),console.log("Note received event emitted"),Q(),Z(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("Error updating note:",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(u.a)(Object(l.a)().mark((function e(t,n){var r,c,s;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("newposition: ",n),e.prev=1,r={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(z.token)}},t.position||{x:0,y:0},e.next=6,x.a.put("/api/note/".concat(t._id),{position:n},r);case 6:c=e.sent,s=c.data,a((function(e){return e.map((function(e){return e._id===s._id?Object(ie.a)(Object(ie.a)({},e),{},{position:s.position}):e}))})),Z(),C.emit("new note",{board:{_id:A._id,users:A.users}},s),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),console.error("Error updating note:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,n){return e.apply(this,arguments)}}(),Z=function(){var e=Object(u.a)(Object(l.a)().mark((function e(){var t,n,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={headers:{Authorization:"Bearer ".concat(z.token)}},e.next=4,x.a.get("/api/board/".concat(A._id,"/notes"),t);case 4:n=e.sent,r=n.data,a(r),console.log("Fetched notes: ",r),C.emit("join board",A._id),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Error fetching board notes:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){(C=Object(ee.a)("http://localhost:5000")).emit("setup",z),C.on("connected",(function(){return K(!0)})),C.on("update board",(function(e){console.log("Received update from server:",e),Z()})),console.log("Selected board:",A)}),[]),Object(r.useEffect)((function(){Z(),A}),[A]);var $=function(){k(!1)},te=function(){var e=Object(u.a)(Object(l.a)().mark((function e(t){var n,r,c;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={headers:{Authorization:"Bearer ".concat(z.token)}},console.log(t),e.next=5,x.a.post("/api/note",{title:t.title,content:t.content,boardId:t.boardId,position:{x:0,y:0},color:"yellow"},n);case 5:r=e.sent,c=r.data,console.log("New note created:",c),a((function(e){return[].concat(Object(E.a)(e),[c])})),C.emit("note received",c),console.log("Note received event emitted"),$(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Error creating note:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(u.a)(Object(l.a)().mark((function e(t){var n,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={headers:{Authorization:"Bearer ".concat(z.token)}},e.next=4,x.a.delete("/api/note/".concat(t),n);case 4:r=e.sent,r.data,a((function(e){return e.filter((function(e){return e._id!==t}))})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error removing note:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)(o.b,{p:6,children:[Object(f.jsxs)(o.i,{align:"stretch",spacing:4,children:[Object(f.jsxs)(o.f,{justifyContent:"space-between",children:[Object(f.jsx)(p.a,{onClick:function(){F(null),y.push("/boards")},children:"Back to My Boards"}),Object(f.jsx)(o.h,{fontFamily:"Work sans",fontSize:"2xl",fontWeight:"bold",children:A.boardName.toUpperCase()}),Object(f.jsx)(p.a,{onClick:function(){k(!0)},children:"New note"}),Object(f.jsx)(je,{})]}),n.length>0?n.map((function(e){return Object(f.jsx)(be,{id:e._id,title:e.title,content:e.content,createdAt:e.createdAt,updatedAt:e.updatedAt,color:e.color,xpos:e.position?e.position.x:0,ypos:e.position?e.position.y:0,onEdit:function(){console.log("Editing note:",e),function(e){h(e),J(!0)}(e)},onRemove:function(){return ne(e._id)},onDragStop:function(t,n){return X(e,n)}},e._id)})):Object(f.jsx)(o.h,{children:"No notes available for this board."})]}),Object(f.jsx)(se,{isOpen:w,onClose:$,onCreateNote:te,boardId:A._id}),Object(f.jsxs)(N.f,{isOpen:M,onClose:Q,children:[Object(f.jsx)(N.l,{}),Object(f.jsxs)(N.i,{children:[Object(f.jsx)(N.k,{children:"Edit Note"}),Object(f.jsx)(N.h,{}),Object(f.jsxs)(N.g,{children:[Object(f.jsx)(o.h,{children:"Title"}),Object(f.jsx)(j.a,{placeholder:"New title...",value:null===b||void 0===b?void 0:b.title,onChange:function(e){return h((function(t){return Object(ie.a)(Object(ie.a)({},t),{},{title:e.target.value})}))}}),Object(f.jsx)(o.h,{children:"Content"}),Object(f.jsx)(j.a,{placeholder:"New content...",value:null===b||void 0===b?void 0:b.content,onChange:function(e){return h((function(t){return Object(ie.a)(Object(ie.a)({},t),{},{content:e.target.value})}))}})]}),Object(f.jsxs)(N.j,{children:[Object(f.jsx)(p.a,{colorScheme:"blue",mr:3,onClick:function(){return V(b)},children:"Save"}),Object(f.jsx)(p.a,{onClick:Q,children:"Cancel"})]})]})]})]})},he=function(){var e=S(),t=e.selectedBoard,n=e.setSelectedBoard,a=e.user,c=e.boards,i=e.setBoards,d=Object(s.e)(),b=function(){var e=Object(u.a)(Object(l.a)().mark((function e(){var t,n,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a&&a.token){e.next=4;break}return console.error("user or token is undefined"),e.abrupt("return");case 4:return t={headers:{Authorization:"Bearer ".concat(a.token)}},e.next=7,x.a.get("/api/board",t);case 7:n=e.sent,r=n.data,console.log("Boards data:",r),i(r),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Error fetching boards:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){a&&a.token&&b()}),[a]);return Object(f.jsx)(o.b,{className:"board-page",p:3,bg:"white",w:"100%",borderRadius:"lg",borderWidth:"1px",children:t?Object(f.jsx)(pe,{}):Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)(ae.a,{in:!t,children:[Object(f.jsxs)(o.b,{pb:3,px:3,fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",display:"flex",w:"100%",justifyContent:"space-between",alignItems:"center",children:["My Boards",Object(f.jsx)(oe,{onClose:function(){},children:Object(f.jsx)(p.a,{display:"flex",fontSize:{base:"17px",md:"10px",lg:"17px"},rightIcon:Object(f.jsx)(B.a,{}),children:"New Board"})})]}),Object(f.jsx)(o.g,{overflowY:"scroll",children:c?c.map((function(e){return Object(f.jsx)(o.b,{onClick:function(){return function(e){n(e),d.push("/boards/".concat(e._id))}(e)},cursor:"pointer",bg:t===e?"#38B2AC":"#E8E8E8",color:t===e?"white":"black",px:3,py:2,borderRadius:"lg",children:Object(f.jsx)(o.h,{children:e.boardName})},e._id)})):Object(f.jsx)(D,{})})]})})})};var Oe=function(){return Object(f.jsx)("div",{className:"App",children:Object(f.jsxs)(_,{children:[Object(f.jsx)(s.a,{path:"/",component:k,exact:!0}),Object(f.jsx)(s.a,{path:"/chats",component:re,exact:!0}),Object(f.jsx)(s.a,{path:"/boards",component:he})]})})},xe=n(15),fe=n(48);c.a.render(Object(f.jsx)(xe.a,{children:Object(f.jsx)(fe.a,{children:Object(f.jsx)(_,{children:Object(f.jsx)(Oe,{})})})}),document.getElementById("root"))}},[[217,1,2]]]);
//# sourceMappingURL=main.d48497e1.chunk.js.map